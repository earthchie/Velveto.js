!function(window){"use strict";window.Velveto=window.Velveto||{},Velveto.ajax={x:[],abortAll:function(){for(var e in Velveto.ajax.x)Velveto.ajax.x[e].abort()},xhr:function(){for(a=0;4>a;a++)try{return a?new ActiveXObject([,"Msxml2","Msxml3","Microsoft"][a]+".XMLHTTP"):new XMLHttpRequest}catch(e){}},sendRequest:function(e,t,o,a,n){if(o=o||null,"object"==typeof o){var i="";for(var l in o)i+="&"+l+"="+o[l];o=i.substring(1)}var r=new Velveto.ajax.xhr;r.onreadystatechange=function(){if(4==r.readyState){for(var e in Velveto.ajax.x)if(Velveto.ajax.x[e]==r){Velveto.ajax.x.splice(e,1);break}200==r.status?"function"==typeof a&&a(r.responseText):"function"==typeof n&&n(r)}},r.open(e.toString().toUpperCase(),t,!0),r.send(o),Velveto.ajax.x.push(r)},GET:function(e,t,o){Velveto.ajax.sendRequest("GET",e,null,t,o)},HEAD:function(e,t,o){Velveto.ajax.sendRequest("HEAD",e,null,t,o)},PURGE:function(e,t,o){Velveto.ajax.sendRequest("PURGE",e,null,t,o)},COPY:function(e,t,o){Velveto.ajax.sendRequest("COPY",e,null,t,o)},OPTIONS:function(e,t,o){Velveto.ajax.sendRequest("OPTIONS",e,null,t,o)},POST:function(e,t,o){Velveto.ajax.sendRequest("POST",e.url||e,e.data||null,t,o)},DELETE:function(e,t,o){Velveto.ajax.sendRequest("DELETE",e.url||e,e.data||null,t,o)},PUT:function(e,t,o){Velveto.ajax.sendRequest("PUT",e.url||e,e.data||null,t,o)},PATCH:function(e,t,o){Velveto.ajax.sendRequest("PATCH",e.url||e,e.data||null,t,o)},LINK:function(e,t,o){Velveto.ajax.sendRequest("LINK",e.url||e,e.data||null,t,o)},UNLINK:function(e,t,o){Velveto.ajax.sendRequest("UNLINK",e.url||e,e.data||null,t,o)},executeScript:function(url){Velveto.ajax.GET(url,eval)}},Velveto.session={get:function(e){return localStorage?localStorage.getItem(e)||"":""},set:function(e,t){localStorage&&localStorage.setItem(e,t)},remove:function(e){localStorage&&localStorage.removeItem(e)}};var load=function(filename,history){Velveto.ajax.abortAll(),setTimeout(function(){var body=document.getElementById("velveto");if(body){var loading=body.getAttribute("data-loading-indicator");null!=loading&&"false"!=loading&&"0"!=loading&&(body.innerHTML=loading),Velveto.fireEvent(document.getElementById("velveto"),"beforeLoad"),Velveto.ajax.get("app/"+filename+".html",function(r){body.innerHTML=r;var scripts=document.querySelectorAll("#velveto script");for(var i in scripts)scripts[i].innerHTML&&eval(scripts[i].innerHTML),scripts[i].src&&Velveto.ajax.executeScript(scripts[i].src);for(var a=document.getElementsByTagName("a"),i=0;i<a.length;i++)a[i].href.indexOf(Velveto.getBaseURL())>-1&&a[i].href.indexOf("#!")>-1&&null===a[i].getAttribute("data-ajax")&&(a[i].setAttribute("data-ajax","true"),a[i].addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t=JSON.stringify(Velveto.getPathData(window.location.hash)),o=JSON.stringify(Velveto.getPathData(this.href));return t!=o&&Velveto.goTo(this.href),!1})),a[i].href.indexOf("#!")<0&&a[i].href.indexOf("#")>-1&&null===a[i].getAttribute("data-smooth")&&(a[i].setAttribute("data-smooth","true"),a[i].addEventListener("click",function(e){e.preventDefault();var t=document.getElementById(this.href.split("#").pop());return Velveto.scrollTo(t),!1}));Velveto.fireEvent(document.getElementById("velveto"),"loaded"),history!==!1&&pushHistory()},function(){Velveto.fireEvent(document.getElementById("velveto"),"loadFail")})}else console.error("Error - Element with id = velveto is not found.")},10)},pushHistory=function(){var e=Velveto.history();(0==e.length||e[e.length-1]!=window.location.hash)&&(e.push(window.location.hash),session.set("Velveto",e.join(" || ")))};Velveto.fireEvent=function(e,t){if(document.createEventNodeList){var o=document.createEventNodeList();e.fireEvent(t,o)}else{var o=document.createEvent("HTMLEvents");o.initEvent(t,!0,!0),e.dispatchEvent(o)}},Velveto.back=function(){if(Velveto.isBackable()){var e=Velveto.history();e.pop(),Velveto.goTo(e.pop()),Velveto.session.set("Velveto",e.join(" || "))}},Velveto.clearHistory=function(){Velveto.session.set("Velveto","")},Velveto.getBaseURL=function(){return window.location.origin+window.location.pathname},Velveto.getPath=function(){return window.location.hash.replace("#!","")},Velveto.getPathData=function(e){var t=!1,o={};if(e||(t=!0,e=window.location.hash),e=decodeURI(e.replace(Velveto.getBaseURL(),"").replace("#!","")),e.indexOf("?")>-1?(e=e.split("?"),o.path=e[0],o.params=e[1]):(o.path=e,o.params=""),e=o.path,"/"==e.charAt(0)&&(e=e.substring(1)),"/"==e.charAt(e.length-1)&&(e=e.slice(0,-1)),o.dir=e.split("/"),"/"!=o.path.charAt(0)&&(o.path="/"+o.path),-1==o.path.indexOf(".")?"/"!=o.path.charAt(o.path.length-1)&&(o.path+="/"):"/"==o.path.charAt(o.path.length-1)&&(o.path=o.path.slice(0,-1)),""!=o.params){var a=o.params.split("&"),n={};for(var i in a)if(-1==a[i].indexOf("="))n[a[i]]="";else{var l=a[i].split("=");n[l[0]]=l[1]}o.params=n}return t&&Velveto.setPathData(o.dir,o.params),o},Velveto.goTo=function(e,t,o){var a=this.getPathData(e);o!==!1&&this.setPathData(a.dir,a.params),load(a.dir[0],t)},Velveto.history=function(){return Velveto.session.get("Velveto")?Velveto.session.get("Velveto").split(" || "):[]},Velveto.isBackable=function(){return Velveto.history().length>2},Velveto.refresh=function(){Velveto.goTo(window.location.hash,!1,!1)},Velveto.scrollTo=function(e,t){var o=(new Date).getTime(),t=t||250,a=window.scrollY,e=e.offsetTop,n=setInterval(function(){var i=Math.min(1,((new Date).getTime()-o)/t);document.body.scrollTop=a+i*(e-a),1==i&&clearInterval(n)},25);document.body.style.scrollTop=a},Velveto.setPathData=function(e,t){var o="?",a="";if(e&&(a="/"+e.join("/"),-1==a.indexOf(".")&&(a+="/")),t)for(var n in t)o+=t[n]?n+"="+t[n]+"&":n+"&";o=o.slice(0,-1),a&&"//"!=a||(a="",o=o.substring(1)),history.pushState(Velveto.getBaseURL(),"",Velveto.getBaseURL()+"#!"+a+o)},window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),""==window.location.hash?Velveto.goTo("home"):Velveto.goTo(window.location.hash),window.addEventListener("hashchange",function(){Velveto.goTo(window.location.hash)})}(window);
//# sourceMappingURL=velveto.min.js.map